{"paragraphs":[{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1475165123201_427537716","id":"20160929-160523_2066727001","dateCreated":"2016-09-29T16:05:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2115","text":"%pyspark\n\n#Sreedevi Radhakrishnan\n#Daniel Ohara\n#Cloud Computing for Business\n\n\nimport pyspark.mllib\nimport pyspark.mllib.regression\nfrom pyspark.mllib.regression import LabeledPoint\nfrom pyspark.sql.functions import *\nfrom pyspark.mllib.regression import LinearRegressionWithSGD\nfrom pyspark.mllib.feature import StandardScaler, StandardScalerModel\nfrom pyspark.mllib.linalg import Vectors\nfrom pyspark.mllib.util import MLUtils\n\nhouses = sc.textFile('hdfs://sandbox.hortonworks.com/tmp/boston-data/boston_house.csv')\nhouses = houses.map(lambda line: line.split(\",\"))\nheader = houses.first()\nheaderless_houses = houses.filter(lambda line: line != header)\ndf = headerless_houses.map(lambda line: Row(CRIM = line[0], ZN = line[1], INDUS=line[2], CHAS=line[3], NOX=line[4], RM=line[5], AGE=line[6], DIS=line[7], RAD=line[8], TAX=line[9], PTRATIO=line[10], B=line[11], LSTAT=line[12])).toDF()\n\nfeatures = df.map(lambda row: row[0:])\n\nmodel = StandardScaler(withMean=True, withStd=True).fit(features)\n\ntransformedFeatures = model.transform(features)\nbostonHouse = headerless_houses.map(lambda row:row[13])\n\n\ntransformedData = bostonHouse.zip(transformedFeatures)\n\ntransformedData = transformedData.map(lambda row: LabeledPoint(row[0],[row[1]]))\n\n\n\n\nlinearModel = LinearRegressionWithSGD.train(transformedData, intercept=True)\n\ntestingHousesData = sc.textFile('hdfs://sandbox.hortonworks.com/tmp/boston-data/verification.csv')\ntestingHouses = testingHousesData.map(lambda line: line.split(\",\"))\ntestingHeaders = testingHouses.first()\nheaderless_Testing = testingHouses.filter(lambda line: line != testingHeaders)\n\ntesting_df = headerless_Testing.map(lambda line: Row(CRIM = line[0], ZN=line[1],INDUS=line[2],CHAS=line[3],NOX=line[4],RM=line[5],AGE=line[6],DIS=line[7],RAD=line[8],TAX=line[9],PTRATIO=line[10],B=line[11],LSTAT=line[12])).toDF()\n\ntesting_features = testing_df.map(lambda row: row[0:])\n\n# print(testing_features.take(3))\n\ntestingTransformedFeatures = model.transform(testing_features)\n\n# print(testingTransformedFeatures.take(3))\n\nverify_predictions = linearModel.predict(testingTransformedFeatures)\n\nprint(verify_predictions.take(3))\n\nverify_predictions.saveAsTextFile('hdfs://sandbox.hortonworks.com/tmp/boston-data/predicted_results');\n\n\n","dateUpdated":"2016-09-29T16:06:25+0000","dateFinished":"2016-09-29T16:06:36+0000","dateStarted":"2016-09-29T16:06:25+0000","result":{"code":"SUCCESS","type":"TEXT","msg":"[17.421431247081845, 21.041183220138802, 20.464012215912057]\n"},"focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1475165129386_768440566","id":"20160929-160529_1413913341","dateCreated":"2016-09-29T16:05:29+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2189"}],"name":"Group-8-Boston-House","id":"2BX55ASNJ","angularObjects":{"2BW4S5NJ4:shared_process":[],"2BY1Y2HJG:shared_process":[],"2BVYH21ZJ:shared_process":[],"2BV6637D6:shared_process":[],"2BX5CPDSX:shared_process":[],"2BWHGGFZJ:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}